<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Yalla Scooter | Dual System</title>
    
    <!-- Firebase & Icons -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #007bff; --admin-bg: #1a1a2e; --staff-bg: #f8f9fa;
            --success: #28a745; --danger: #dc3545; --warning: #ffc107;
        }
        * { box-sizing: border-box; font-family: 'Cairo', sans-serif; outline: none; }
        body { margin: 0; min-height: 100vh; display: flex; flex-direction: column; transition: 0.3s; }

        /* --- Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ --- */
        #login-overlay { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .login-box { background: #111; padding: 40px; border-radius: 20px; text-align: center; border: 1px solid #333; width: 90%; max-width: 350px; }
        .login-box input { width: 100%; padding: 15px; margin: 20px 0; border-radius: 10px; border: none; text-align: center; font-size: 20px; letter-spacing: 5px; }

        /* --- ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø¹Ø§Ù…Ø© --- */
        .container { padding: 15px; max-width: 1000px; margin: 0 auto; width: 100%; }
        .btn { border: none; padding: 12px; border-radius: 10px; font-weight: bold; cursor: pointer; width: 100%; font-size: 15px; margin-top: 5px; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .hidden { display: none !important; }

        /* --- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…ÙˆØ¸Ù (Rental) --- */
        .rental-mode { background: var(--staff-bg); color: #333; }
        .trip-card { background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); margin-bottom: 15px; border-right: 5px solid var(--primary); }
        .timer { font-size: 30px; font-weight: 800; font-family: monospace; color: #333; }

        /* --- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ø¯Ù…Ù† (Admin) --- */
        .admin-mode { background: var(--admin-bg); color: white; }
        .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .stat-card { background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.1); text-align: center; }
        .admin-table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 13px; }
        .admin-table th { background: #000; padding: 10px; color: #aaa; }
        .admin-table td { background: rgba(255,255,255,0.05); padding: 10px; border-bottom: 1px solid #333; }

        /* --- AI Assistant --- */
        .ai-fab { position: fixed; bottom: 20px; left: 20px; width: 60px; height: 60px; background: linear-gradient(45deg, #ff00cc, #3333ff); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; color: white; cursor: pointer; box-shadow: 0 0 20px rgba(255,0,204,0.5); z-index: 1000; }
        .ai-window { position: fixed; bottom: 90px; left: 20px; width: 300px; height: 400px; background: #161b22; border: 1px solid #30363d; border-radius: 15px; display: none; flex-direction: column; overflow: hidden; z-index: 1000; }
        .ai-chat { flex: 1; padding: 10px; overflow-y: auto; font-size: 13px; }
        .ai-input-area { padding: 10px; border-top: 1px solid #30363d; display: flex; }
        .msg-ai { background: #21262d; padding: 8px; border-radius: 10px; margin-bottom: 5px; color: #c9d1d9; border-left: 3px solid #ff00cc; }
        .msg-user { background: #1f6feb; padding: 8px; border-radius: 10px; margin-bottom: 5px; color: white; align-self: flex-end; text-align: left; }
    </style>
</head>
<body>

    <!-- 1. Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ÙˆØ­Ø¯Ø© -->
    <div id="login-overlay">
        <div class="login-box">
            <h1 style="color:white; margin-bottom:5px;">Yalla Scooter</h1>
            <p style="color:#777; font-size:12px;">System V30</p>
            <input type="password" id="passInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯" inputmode="numeric">
            <button class="btn btn-primary" onclick="checkLogin()">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>

    <!-- 2. ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ (Ù„Ù„Ù…ÙˆØ¸Ù ÙˆØ§Ù„Ø£Ø¯Ù…Ù†) -->
    <div id="app-container" class="container hidden">
        
        <!-- Ù‡ÙŠØ¯Ø± Ø§Ù„Ø£Ø¯Ù…Ù† (ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ù„Ù„Ø£Ø¯Ù…Ù†) -->
        <div id="admin-header" class="hidden" style="margin-bottom:20px;">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h2><i class="fas fa-user-secret"></i> Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°ÙƒÙŠØ©</h2>
                <button onclick="logout()" style="background:none; border:none; color:#dc3545; font-weight:bold;">Ø®Ø±ÙˆØ¬</button>
            </div>
            
            <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© -->
            <div class="stat-grid">
                <div class="stat-card">
                    <h3 id="totalIncome" style="color:#28a745; margin:0;">0</h3>
                    <small>Ø¥ÙŠØ±Ø§Ø¯ Ø§Ù„ÙŠÙˆÙ…</small>
                </div>
                <div class="stat-card">
                    <h3 id="activeTripsCount" style="color:#007bff; margin:0;">0</h3>
                    <small>Ø±Ø­Ù„Ø§Øª Ø¬Ø§Ø±ÙŠØ©</small>
                </div>
                <div class="stat-card">
                    <h3 id="onlineStaffCount" style="color:#ffc107; margin:0;">0</h3>
                    <small>Ù…ÙˆØ¸ÙÙŠÙ† Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</small>
                </div>
            </div>

            <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† -->
            <h4 style="color:#aaa; margin-bottom:5px;">ğŸ”´ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø­ÙŠØ©</h4>
            <table class="admin-table">
                <thead><tr><th>Ø§Ù„Ù…ÙˆØ¸Ù</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>ØªØ­ÙƒÙ…</th></tr></thead>
                <tbody id="staffTableBody"></tbody>
            </table>
        </div>

        <!-- Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…ÙˆØ¸Ù (ÙŠØ¸Ù‡Ø± Ù„Ù„Ù…ÙˆØ¸Ù ÙÙ‚Ø·) -->
        <div id="staff-header" class="hidden" style="margin-bottom:20px; display:flex; justify-content:space-between; align-items:center;">
            <h3>ğŸ›µ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ£Ø¬ÙŠØ±</h3>
            <button onclick="logout()" style="background:#eee; padding:5px 15px; border-radius:20px; border:none;">Ø®Ø±ÙˆØ¬</button>
        </div>

        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… (Ù…Ø´ØªØ±ÙƒØ©) -->
        <button class="btn btn-primary" onclick="document.getElementById('newTripModal').style.display='flex'" style="padding:15px; font-size:18px; margin-bottom:20px;">
            <i class="fas fa-plus"></i> ØªØ³Ø¬ÙŠÙ„ Ø±Ø­Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
        </button>

        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø­Ù„Ø§Øª -->
        <div id="trips-list"></div>

    </div>

    <!-- 3. Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ AI (Ù„Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·) -->
    <div id="ai-assistant" class="hidden">
        <div class="ai-fab" onclick="toggleAI()"><i class="fas fa-robot"></i></div>
        <div class="ai-window" id="aiWindow">
            <div style="padding:10px; background:#21262d; border-bottom:1px solid #30363d; font-weight:bold;">ğŸ§  Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</div>
            <div class="ai-chat" id="aiChatBody">
                <div class="msg-ai">Ø£Ù‡Ù„Ø§Ù‹ ÙŠØ§ Ø±ÙŠØ³! Ø£Ù†Ø§ Ø´Ø§ÙŠÙ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. Ø§Ø³Ø£Ù„Ù†ÙŠ Ø¹Ù† Ø§Ù„ÙÙ„ÙˆØ³ØŒ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ØŒ Ø£Ùˆ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†.</div>
            </div>
            <div class="ai-input-area">
                <input type="text" id="aiInput" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ..." style="flex:1; background:transparent; border:none; color:white;">
                <button onclick="askAI()" style="background:none; border:none; color:#ff00cc;"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ Ø±Ø­Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© -->
    <div id="newTripModal" class="hidden" style="position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:2000; align-items:center; justify-content:center;">
        <div style="background:white; padding:20px; border-radius:15px; width:90%; max-width:400px; text-align:right;">
            <h3>Ø±Ø­Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
            <input type="text" id="t_scooter" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø³ÙƒÙˆØªØ± (S1)" style="width:100%; padding:10px; margin-bottom:10px; border:1px solid #ccc;">
            <input type="text" id="t_phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„" style="width:100%; padding:10px; margin-bottom:10px; border:1px solid #ccc;">
            <input type="text" id="t_name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„" style="width:100%; padding:10px; margin-bottom:10px; border:1px solid #ccc;">
            <button class="btn btn-primary" onclick="startTrip()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¨Ø¯Ø¡</button>
            <button class="btn btn-danger" onclick="document.getElementById('newTripModal').style.display='none'" style="margin-top:5px;">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <script>
        // --- 1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙØ§ÙŠØ±Ø¨ÙŠØ³ ---
        const firebaseConfig = {
            apiKey: "AIzaSyB2J3KViN4aZYRJ43rYGFtwkmy-jZXBO6c",
            authDomain: "yalla-scooter-pro.firebaseapp.com",
            databaseURL: "https://yalla-scooter-pro-default-rtdb.firebaseio.com",
            projectId: "yalla-scooter-pro",
            storageBucket: "yalla-scooter-pro.firebasestorage.app",
            messagingSenderId: "185791475252",
            appId: "1:185791475252:web:fea7d7e2e9a18cd8a86461"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // --- 2. Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ---
        let IS_ADMIN = false;
        let todayRevenue = 0;
        let activeTripsCount = 0;
        let issuesList = [];

        // --- 3. Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø°ÙƒÙŠ ---
        function checkLogin() {
            const p = document.getElementById('passInput').value;
            
            if (p === "1213") {
                // ÙˆØ¶Ø¹ Ø§Ù„Ù…ÙˆØ¸Ù (Rental Mode)
                IS_ADMIN = false;
                document.body.classList.add('rental-mode');
                document.getElementById('staff-header').classList.remove('hidden');
                initSystem();
            } 
            else if (p === "9924") {
                // ÙˆØ¶Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Admin Mode)
                IS_ADMIN = true;
                document.body.classList.add('admin-mode');
                document.getElementById('admin-header').classList.remove('hidden');
                document.getElementById('ai-assistant').classList.remove('hidden');
                initSystem();
                initAdminFeatures();
            } 
            else {
                alert("âŒ ÙƒÙˆØ¯ Ø®Ø§Ø·Ø¦");
            }
        }

        function initSystem() {
            document.getElementById('login-overlay').style.display = 'none';
            document.getElementById('app-container').classList.remove('hidden');
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø­Ù„Ø§Øª Ø§Ù„Ø¬Ø§Ø±ÙŠØ© (Ù„Ù„Ø¬Ù…ÙŠØ¹)
            db.ref('active_trips').on('value', snap => {
                const list = document.getElementById('trips-list');
                list.innerHTML = "";
                activeTripsCount = 0;
                
                if(snap.exists()) {
                    snap.forEach(t => {
                        const trip = t.val();
                        const key = t.key;
                        activeTripsCount++;
                        
                        // Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆÙ‚Øª
                        let duration = Math.floor((Date.now() - trip.start)/60000);
                        
                        list.innerHTML += `
                            <div class="trip-card">
                                <div style="display:flex; justify-content:space-between;">
                                    <h2>${trip.scooter}</h2>
                                    <span style="color:#777">${trip.client}</span>
                                </div>
                                <div class="timer">${duration} Ø¯Ù‚ÙŠÙ‚Ø©</div>
                                <div style="font-size:12px; color:#888;">Ø¨ÙˆØ§Ø³Ø·Ø©: ${trip.staff || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</div>
                                <button class="btn btn-danger" onclick="endTrip('${key}')" style="margin-top:10px;">Ø¥Ù†Ù‡Ø§Ø¡ ÙˆØ­Ø³Ø§Ø¨</button>
                            </div>
                        `;
                    });
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø¯Ù…Ù†
                if(IS_ADMIN) document.getElementById('activeTripsCount').innerText = activeTripsCount;
            });
        }

        // --- 4. Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø· ---
        function initAdminFeatures() {
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ
            const today = new Date().toISOString().split('T')[0];
            db.ref(`history/${today}`).on('value', snap => {
                todayRevenue = 0;
                issuesList = [];
                if(snap.exists()) {
                    snap.forEach(child => {
                        const r = child.val();
                        todayRevenue += (r.cost || 0);
                        if(r.hasIssue) issuesList.push(`${r.scooter}: ${r.issueReason}`);
                    });
                }
                document.getElementById('totalIncome').innerText = todayRevenue + " Ø¬.Ù…";
            });

            // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
            db.ref('online_staff').on('value', snap => {
                const tbody = document.getElementById('staffTableBody');
                tbody.innerHTML = "";
                let count = 0;
                if(snap.exists()) {
                    snap.forEach(s => {
                        count++;
                        tbody.innerHTML += `
                            <tr>
                                <td>${s.val().name}</td>
                                <td style="color:#28a745">Online</td>
                                <td><button onclick="banUser('${s.key}')" style="background:#dc3545; color:white; border:none; padding:5px; border-radius:5px;">Ø·Ø±Ø¯</button></td>
                            </tr>
                        `;
                    });
                }
                document.getElementById('onlineStaffCount').innerText = count;
            });
        }

        // --- 5. ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ´ØºÙŠÙ„ (Ù„Ù„Ø¬Ù…ÙŠØ¹) ---
        function startTrip() {
            const scooter = document.getElementById('t_scooter').value;
            const client = document.getElementById('t_name').value;
            
            if(!scooter) return alert("Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ø³ÙƒÙˆØªØ±");
            
            db.ref('active_trips').push({
                scooter, client, 
                start: Date.now(),
                staff: IS_ADMIN ? 'Admin' : 'Staff'
            });
            
            document.getElementById('newTripModal').style.display = 'none';
        }

        function endTrip(key) {
            db.ref('active_trips/'+key).once('value', snap => {
                const t = snap.val();
                let mins = Math.ceil((Date.now() - t.start)/60000);
                if(mins < 15) mins = 15; // Ø­Ø¯ Ø£Ø¯Ù†Ù‰
                
                let cost = mins * 1; // Ø§Ù„Ø³Ø¹Ø±
                
                if(confirm(`Ø¥Ù†Ù‡Ø§Ø¡ Ø±Ø­Ù„Ø© ${t.scooter}ØŸ\nØ§Ù„Ù…Ø¯Ø©: ${mins} Ø¯Ù‚ÙŠÙ‚Ø©\nØ§Ù„Ø­Ø³Ø§Ø¨: ${cost} Ø¬Ù†ÙŠÙ‡`)) {
                    // ØªØ±Ø­ÙŠÙ„ Ù„Ù„ØªØ§Ø±ÙŠØ®
                    const today = new Date().toISOString().split('T')[0];
                    db.ref(`history/${today}`).push({
                        ...t, end: Date.now(), cost: cost, duration: mins
                    });
                    // Ø­Ø°Ù Ù…Ù† Ø§Ù„Ù†Ø´Ø·
                    db.ref('active_trips/'+key).remove();
                }
            });
        }

        // --- 6. Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ (AI Logic) ---
        function toggleAI() {
            const win = document.getElementById('aiWindow');
            win.style.display = win.style.display === 'flex' ? 'none' : 'flex';
        }

        function askAI() {
            const input = document.getElementById('aiInput');
            const q = input.value.toLowerCase();
            const body = document.getElementById('aiChatBody');
            
            if(!q) return;

            // Ø¹Ø±Ø¶ Ø³Ø¤Ø§Ù„Ùƒ
            body.innerHTML += `<div class="msg-user">${input.value}</div>`;
            
            // ØªØ­Ù„ÙŠÙ„ ÙˆØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø±Ø¯
            let reply = "Ù…Ø´ ÙØ§Ù‡Ù… Ù‚ØµØ¯ÙƒØŒ Ø§Ø³Ø£Ù„Ù†ÙŠ Ø¹Ù† Ø§Ù„ÙÙ„ÙˆØ³ Ø£Ùˆ Ø§Ù„Ø§Ø³ÙƒÙˆØªØ±Ø§Øª.";
            
            if(q.includes('Ø¯Ø®Ù„') || q.includes('Ø§ÙŠØ±Ø§Ø¯') || q.includes('ÙƒØ§Ù… Ø§Ù„Ù†Ù‡Ø§Ø±Ø¯Ø©') || q.includes('ÙÙ„ÙˆØ³')) {
                reply = `ğŸ’° Ø¥ÙŠØ±Ø§Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø±Ø¯Ø© Ù„Ø­Ø¯ Ø¯Ù„ÙˆÙ‚ØªÙŠ: <b>${todayRevenue} Ø¬Ù†ÙŠÙ‡</b>.`;
            }
            else if(q.includes('Ø´ØºØ§Ù„') || q.includes('Ø±Ø­Ù„Ø©') || q.includes('Ø¨Ø±Ø©')) {
                reply = `ğŸ›µ Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠÙ‡ <b>${activeTripsCount}</b> Ø³ÙƒÙˆØªØ±Ø§Øª Ù…Ø£Ø¬Ø±Ø© ÙÙŠ Ø§Ù„Ø´Ø§Ø±Ø¹.`;
            }
            else if(q.includes('Ø§Ø¹Ø·Ø§Ù„') || q.includes('Ø¹Ø·Ù„') || q.includes('Ù…Ø´Ø§ÙƒÙ„')) {
                if(issuesList.length > 0) reply = `âš ï¸ ÙÙŠÙ‡ Ù…Ø´Ø§ÙƒÙ„ Ù…ØªØ³Ø¬Ù„Ø© Ø§Ù„Ù†Ù‡Ø§Ø±Ø¯Ø©:\n- ${issuesList.join('\n- ')}`;
                else reply = "âœ… Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ Ù…ÙÙŠØ´ Ø£ÙŠ Ø£Ø¹Ø·Ø§Ù„ Ø§ØªØ³Ø¬Ù„Øª Ø§Ù„Ù†Ù‡Ø§Ø±Ø¯Ø©.";
            }
            else if(q.includes('Ù…ÙˆØ¸Ù') || q.includes('Ù…ÙŠÙ† ÙØ§ØªØ­')) {
                const count = document.getElementById('onlineStaffCount').innerText;
                reply = `ğŸ‘¥ ÙÙŠÙ‡ <b>${count}</b> Ù…ÙˆØ¸ÙÙŠÙ† ÙØ§ØªØ­ÙŠÙ† Ø§Ù„Ø³ÙŠØ³ØªÙ… Ø¯Ù„ÙˆÙ‚ØªÙŠ.`;
            }

            // ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªÙÙƒÙŠØ±
            setTimeout(() => {
                body.innerHTML += `<div class="msg-ai">${reply}</div>`;
                body.scrollTop = body.scrollHeight;
            }, 500);

            input.value = "";
        }

        function logout() { location.reload(); }
        function banUser(key) { 
            if(confirm('Ø·Ø±Ø¯ Ø§Ù„Ù…ÙˆØ¸Ù Ø¯Ù‡ØŸ')) db.ref('banned_devices/'+key).set(true); 
        }

    </script>
</body>
</html>
