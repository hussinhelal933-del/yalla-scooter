<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Yalla Finance | Ø§Ù„Ø®Ø²Ù†Ø© ÙˆØ§Ù„Ø§Ø±ØµØ¯Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Orbitron:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --adm-brown: #3E2723; --adm-blue: #00d2ff; --adm-dark: #0f0a09; }
        body { background: var(--adm-dark); color: white; padding: 40px; font-family: 'Cairo'; }
        .ledger-card { background: var(--adm-brown); border-radius: 25px; padding: 30px; border: 1.5px solid var(--adm-blue); }
        .user-row { display: flex; justify-content: space-between; align-items: center; padding: 20px; border-bottom: 1px solid #222; transition: 0.3s; }
        .user-row:hover { background: rgba(255,255,255,0.02); }
        .bal-display { font-family: 'Orbitron'; color: #00ff9d; font-size: 22px; }
        .btn-charge { background: #00ff9d; color: black; border: none; padding: 8px 20px; border-radius: 10px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <div class="ledger-card">
        <div style="text-align:center; margin-bottom:40px;">
            <h1 style="font-family:Orbitron; color:var(--adm-blue);">FINANCE CENTER</h1>
            <p>Ø¥Ø¯Ø§Ø±Ø© Ø£Ø±ØµØ¯Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„ØªØ­ØµÙŠÙ„ Ø§Ù„Ù„Ø­Ø¸ÙŠ</p>
        </div>

        <div id="users-db">
            <!-- Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="app-core.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        // Ø¬Ù„Ø¨ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ´Ø­Ù† Ø£Ø±ØµØ¯ØªÙ‡Ù… Ù„Ø­Ø¸ÙŠØ§Ù‹
        YallaBrain.db.ref('users').on('value', snap => {
            const container = document.getElementById('users-db');
            container.innerHTML = "";
            snap.forEach(user => {
                const u = user.val();
                container.innerHTML += `
                    <div class="user-row">
                        <div>
                            <b>ğŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${u.name || 'Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…'}</b><br>
                            <small style="color:#777;">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${user.key}</small>
                        </div>
                        <div class="bal-display">${(u.balance || 0).toFixed(2)} Ø¬</div>
                        <button class="btn-charge" onclick="recharge('${user.key}')">Ø´Ø­Ù† Ø±ØµÙŠØ¯ +</button>
                    </div>
                `;
            });
        });

        async function recharge(phone) {
            const { value: amt } = await Swal.fire({ 
                title: 'Ø´Ø­Ù† Ø±ØµÙŠØ¯ Ù„Ù„Ø±Ù‚Ù… ' + phone, 
                input: 'number', 
                inputLabel: 'Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡',
                confirmButtonColor: '#00ff9d'
            });
            if(amt) {
                YallaBrain.db.ref('users/' + phone + '/balance').transaction(v => (v || 0) + parseFloat(amt));
                Swal.fire('ØªÙ… Ø§Ù„Ø´Ø­Ù†', 'Ø§Ù„Ø±ØµÙŠØ¯ Ø¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø¢Ù†', 'success');
            }
        }
    </script>
</body>
</html>
